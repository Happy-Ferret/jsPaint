<script type="text/html" id="commonMenuButtonTemplate">
    <div class="button main_menu_item" data-bind="click: Action">
        <div class="menuItemBlock menu-icon" data-bind="css: IconClass"></div>
        <div class="menuItemBlock main_menu_item_text" data-bind="text: Title"></div>
    </div>
</script>

<script type="text/html" id="openMenuButtonTemplate">
    <div class="button main_menu_item">
        <div class="menuItemBlock menu-icon" data-bind="css: IconClass"></div>
        <div class="menuItemBlock main_menu_item_text" data-bind="text: Title"></div>
        <input type="file" class="trap_filepicker" data-bind="event: { change: SelectedCallback }" accept="image/*"/>
    </div>
</script>

<div class="ribbonMenuBar">
    <div class="ribbonTabItem ribbonMainMenuButton" data-bind="click: ShowMenu">&nbsp</div>

    <div class="main_menu" data-bind="visible: IsMenuShown">
        <div class="main_menu_top">
            <div class="ribbonTabItem ribbonMainMenuButton" data-bind="click: HideMenu" style="margin: -1px">&nbsp</div>
        </div>
        <div class="mainMenuIcons" data-bind="foreach: MainMenuItems">
            <!-- ko template: { name: Template, data: $data } -->
            <!-- /ko -->
        </div>
        <div class="mainMenuBottom">&nbsp</div>
    </div>

    <!-- ko foreach: Tabs -->
    <div class="ribbonTabItem ribbonMenuItem"
         data-bind="text: Caption, css: { 'active': IsActive }, click: $parent.SelectTab">
    </div>
    <!-- /ko -->
</div>

<div class="ribbonOuter">
    <div class="ribbonMiddle">
        <div class="ribbonInner"
             data-bind="template: { name: SelectedTab().Template(), data: SelectedTab().Data }"></div>
    </div>
</div>