<html>
<head>
    <title>jPaint demo</title>

    <!-- EXTERNAL LIBS -->
    <script type="text/javascript" src="scripts/knockout-2.2.1.js"></script>

    <!-- INTERNAL LIBS -->
    <script type="text/html" id="windowTemplate"></script>
    <link rel="stylesheet" type="text/css" href="libs/windows/windows-0.9.0.css"/>
    <script type="text/javascript" src="libs/windows/windows-0.9.0.js"></script>

    <script type="text/html" id="ribbonTemplate"></script>
    <link rel="stylesheet" type="text/css" href="libs/ribbon/ribbon.css"/>
    <script type="text/javascript" src="libs/ribbon/ribbon.js"></script>

    <script type="text/html" id="colorpickerTemplate"></script>
    <link rel="stylesheet" type="text/css" href="libs/colorpicker/colorpicker.css"/>
    <script type="text/javascript" src="libs/colorpicker/colorpicker.js"></script>

    <!-- MODULES -->
    <link rel="stylesheet" type="text/css" href="styles/application.css"/>
    <script type="text/javascript" src="scripts/application.js"></script>
    <script type="text/javascript" src="scripts/applicationState.js"></script>

    <script type="text/javascript" src="modules/main/mainViewModel.js"></script>
    <script type="text/html" id="mainTemplate"></script>

    <script type="text/javascript" src="modules/main/mainStatusbarViewModel.js"></script>
    <script type="text/html" id="mainStatusbarTemplate"></script>

    <script type="text/javascript" src="modules/canvas/canvasViewModel.js"></script>
    <script type="text/html" id="canvasTemplate"></script>

    <script type="text/javascript" src="modules/ribbon/homeTabViewModel.js"></script>
    <script type="text/html" id="homeRibbonTabTemplate"></script>
    <script type="text/javascript" src="modules/ribbon/viewTabViewModel.js"></script>
    <script type="text/html" id="viewRibbonTabTemplate"></script>

    <!-- HELPERS -->
    <script type="text/javascript" src="scripts/positionHelper.js"></script>
    <script type="text/javascript" src="scripts/ajaxHelper.js"></script>
    <script type="text/javascript" src="scripts/domHelper.js"></script>

    <!-- OTHER -->
    <link rel="stylesheet" type="text/css" href="styles/modalMarkup.css"/>
    <link rel="stylesheet" type="text/css" href="styles/menu_icons.css"/>
    <link rel="stylesheet" type="text/css" href="styles/print.css" media="print"/>

    <script type="text/html" id="propertiesWindowTemplate"></script>
    <script type="text/javascript" src="modules/modal/propertiesViewModel.js"></script>
    <script type="text/html" id="aboutWindowTemplate"></script>
    <script type="text/html" id="resizeWindowTemplate"></script>
</head>

<script type="text/javascript">
    var Application;

    function loadTemplates() {
        WindowsFramework.includeModule(getElement('windowTemplate'), '/libs/windows/windows-0.9.0.html');
        includeModule(getElement('ribbonTemplate'), '/libs/ribbon/ribbon.html');
        includeModule(getElement('colorpickerTemplate'), 'libs/colorpicker/colorpicker.html');

        includeModule(getElement('mainTemplate'), '/modules/main/mainMarkup.html');
        includeModule(getElement('mainStatusbarTemplate'), '/modules/main/mainStatusbarMarkup.html');
        includeModule(getElement('canvasTemplate'), '/modules/canvas/canvasMarkup.html');
        includeModule(getElement('homeRibbonTabTemplate'), 'modules/ribbon/homeTabMarkup.html');
        includeModule(getElement('viewRibbonTabTemplate'), 'modules/ribbon/viewTabMarkup.html');

        includeModule(getElement('propertiesWindowTemplate'), 'modules/modal/propertiesMarkup.html');
        includeModule(getElement('aboutWindowTemplate'), 'modules/modal/aboutMarkup.html');
        includeModule(getElement('resizeWindowTemplate'), 'modules/modal/resizeMarkup.html');
    }

    function initApplication() {
        loadTemplates();

        Application = new ApplicationViewModel();
        ko.applyBindings(Application, document.body);
    }
</script>

<body onload="initApplication()" id="application" data-bind="event: { mouseup: Dispatcher.EndDragAll }">

<div class="container" id="windowsContainer"
     data-bind="template: { name: 'windowTemplate', foreach: Dispatcher.Windows }"></div>

</body>
</html>